# IO组件实现的质量标准

IO组件指负责将磁盘/网络文件导入导出场景的实现模块。在实现io组件时，我们「追求」这样的实现质量：

- 功能正确性
  - 正确实现标准规定的行为
  - 能够根据标准，附加validation逻辑(optional)
- 性能
  - 支持异步(optional)，特别是文件写，特别是支持包含外链数据的情况
    - 支持进度汇报
  - 充分利用多线程(optional)
  - 通用的性能质量要求
    - 最小化不必要的数据拷贝和中间数据结构
    - 最小化内存和峰值内存使用（不考虑并行度的情况下）
    - 最小化allocation，锁访问次数
- 兼容性和适用性
  - 应针对Read和Write trait实现，而不是具体io目标
  - 在wasm等降级target上可正确运行（上述异步和多线程能够降级关闭）
  - 针对错误输入能够尽可能的处理（best effort行为）并汇报所有异常情况和处理方式
- Bloat free
  - 多线程和异步支持是依赖注入的（避免直接的复杂依赖）
  - 所有可选的功能，都是可以静态关闭的
- 基础设施完善程度
  - 有结构化的性能trace
  - 输出友好的调试log
  - 对于不支持的情况，能够可选的做降级处理，能够log这样的异常情况
  - 有批量化测试的数据集和相关基础设施
    - 数据集包含足够多和常见的的edge case（考虑一个spec coverage的评估方式）
    - 数据集包含典型的压力测试场景

以上标准很难达到，当可作为一个备忘，用以

- 评估某个io实现的成熟程度和质量
- 指导某个io实现的长期改进方向
- 说明仅仅能work的程序对比能很好的work的程序，有明显的开发成本和价值差异
